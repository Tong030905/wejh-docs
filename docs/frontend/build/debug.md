# 小程序调试

小程序调试一般在开发者工具上调试。

## 小程序的三个版本

> 这三个版本和 Taro 编译的两个环境（开发环境和生产环境）没有任何关系，开发以及生产环境的代码都可以上传到上面的三个版本中（不过对包体积有限制）。一般只会上传**生产环境**的代码到微信平台上，因为这样体积小

- 开发版（只能开发者一个人在移动端微信或者开发者工具中使用）
- 体验版（由开发版在开发者工具中上传，可以让所有有体验资格的人在移动端微信中使用）
- 正式版（由体验版在开发者平台上审核后上传，所有微信用户都能全平台使用）

## 开发者工具配置

### 启动配置

第一次打开开发者工具需要选择项目路径，所以先对仓库代码进行一次编译

```bash
pnpm build:weapp
# 或者
pnpm dev:weapp
```

> 编译小程序之前记得配置好一些必要的环境变量

此时项目编译产物会出现在根目录下的 `dist` 文件夹，开发者工具选择到这个文件夹就行。

接着登录自己的微信号，开发者需要此前**找小程序管理员申请开发者身份**才能正常启动小程序

> 微精弘通行证是和微信号绑定的，手机微信，开发者工具登录同一个微信号，就能自动登录微精弘通行证。如果没有自动登录成功，可能是网断了，可能是开发者工具中账号登录失效了，也有可能你压根不是微精弘的开发者

### 小程序配置

开发者工具右上角有个**详情**，里面打开 _本地设置选项卡_ ，里面有很多东西可以选，一般来说不用改。这些配置和项目根目录下的`project.config.json` 是同步的，使用仓库中配置好的就行。

打开 _项目配置选项卡_ ，里面展示了一些域名，在小程序里面请求是不能乱发的，只能发到开发者平台上已添加的域名。如果有需求要请求新域名了，先去开发者平台上把新域名加上去，再重新打开开发者工具，合法的域名应该会被同步过来。（本地设置里面有一项是不校验合法域名，这个打勾了就能在开发者工具中随便请求，但是小程序里面还是请求合法域名）

## 真机调试

请先阅读[真机调试对包体积的限制](build-size.html#真机调试对包体积的限制)

真机调试可以真实化手机运行 UI，API 的环境，比起开发者工具调试关闭一些限制，是有一定意义的。

手机扫个码就能启动调试了，这就是小程序**开发版**，同时电脑上自动会开启一个控制台，手机上打开的小程序会比较卡，因为要和电脑的控制台发包，有一定延迟，建议直接把电脑上的控制台关闭，重新打开小程序开发版，进行真机调试。

> IOS 中开发版手机小程序无法打开调试面板（控制台），Android 可以，但两者都可以连接电脑上的控制台

一般来说一个版本开发得没问题了，会发布**体验版**，让体验者来测试